$(document).ready(function(){var c=$("<tr/>"),h=$("<td/>"),e=$('<input class="us_id" type="hidden" name="us_id[]"/>'),a=$('<input type="text" name="us_cant[]" class="txt_valor"/>'),d=$('<span class="us_cant"/>'),b=$("#cmbInstalador"),f=$("#txtCantidad"),g=$("#disponibles");$("#btn_asignar").click(function(){var l=parseInt(b.val(),10),j=f.val(),i=g.text(),k,m;if(l){j=parseInt(j,10);if(!isNaN(j)){i=parseInt(i,10);if(j>i){j=i}if(j<0){j=0}if(j){k=$('input.us_id[value="'+l+'"]',"#asignados");if(k.length){k=k.parentsUntil("tbody","tr");m=$(".txt_valor",k);m.val(parseInt(m.val(),10)+j);m.next().text(m.val())}else{c.clone().append(h.clone().text(b.children(":selected").text()).prepend(e.clone().val(l)),h.clone().append(a.clone().val(j),d.clone().text(j)),h.clone().text("0")).appendTo("#asignados")}g.text(i-j)}}f.val("")}});$(".us_cant").live("click",function(){$(this).hide().prev().show().select()});$(".txt_valor").live("blur",function(){var m=$(this),n=$("#disponibles"),j=parseInt(m.val(),10),l=parseInt(m.next().text(),10),i=l+parseInt(n.text(),10),k=parseInt(m.parent().parent().find(".instalados").text(),10);if(isNaN(j)){j=0}if(j<k){j=k}else{if(j>i){j=i}}if(j){m.val(j).hide().next().text(j).show()}else{m.parentsUntil("tbody","tr").remove()}n.text(i-j)}).live("keypress",function(i){if(i.which===13){$(this).blur()}})});